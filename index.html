<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PHASE 15 | ELITE TRACKER</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1419 100%);
            color: white; margin: 0; min-height: 100vh; overflow-x: hidden;
        }
        .glass-strong {
            background: rgba(20, 30, 50, 0.85); backdrop-filter: blur(20px);
            border: 1px solid rgba(59, 130, 246, 0.2); box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        .input-box { 
            background: rgba(15, 23, 42, 0.9); border: 2px solid rgba(59, 130, 246, 0.2);
            color: white; border-radius: 12px; padding: 12px; width: 100%; text-align: center; font-weight: 700;
        }
        .tab-btn { flex: 1; padding: 16px; font-size: 10px; font-weight: 800; text-transform: uppercase; color: #64748b; border-bottom: 3px solid transparent; transition: 0.3s; }
        .tab-active { color: #3b82f6; border-bottom: 3px solid #3b82f6; background: rgba(59, 130, 246, 0.05); }
        .accent-text { background: linear-gradient(135deg, #60a5fa 0%, #34d399 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .progress-ring { transform: rotate(-90deg); }
        .progress-ring__circle { transition: stroke-dashoffset 0.4s ease; stroke: #3b82f6; }
        pre { white-space: pre-wrap; word-wrap: break-word; font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        const SCRIPT_URL = 'PASTE_YOUR_URL_HERE';

        window.addEventListener('load', function() {
            const { createElement: h, useState, useEffect } = React;

            function App() {
                const [tab, setTab] = useState('dashboard');
                const [workouts, setWorkouts] = useState([]);
                const [metrics, setMetrics] = useState([]);
                const [consumed, setConsumed] = useState({ p: 0, c: 0, f: 0 });
                const [loading, setLoading] = useState(true);
                const [activeWkt, setActiveWkt] = useState(null);
                const [exData, setExData] = useState([]);

                const templates = {
                    'Upper Push (Hypertrophy)': [{n: 'Incline DB Press', s: 3, r: '8-10'}, {n: 'Dips', s: 3, r: '10-12'}, {n: 'Lateral Raises', s: 3, r: '12-15'}],
                    'Upper Pull (Strength)': [{n: 'Chin-Ups (Weighted)', s: 3, r: '6-8'}, {n: 'Barbell Rows', s: 3, r: '8-10'}, {n: 'Face Pulls', s: 3, r: '15-20'}],
                    'Lower Quad (Endurance)': [{n: 'Back Squat', s: 4, r: '8-10'}, {n: 'Leg Press', s: 3, r: '12-15'}],
                    'Lower Ham (Power)': [{n: 'Deadlift', s: 3, r: '5-8'}, {n: 'Romanian Deadlift', s: 3, r: '10-12'}],
                    'Half-Marathon Prep': [{n: 'Zone 2 Run', s: 1, r: '45 min'}]
                };

                useEffect(() => {
                    fetch(SCRIPT_URL).then(r => r.json()).then(data => {
                        setWorkouts(data.workouts || []);
                        setMetrics(data.metrics || []);
                        setLoading(false);
                    }).catch(e => setLoading(false));
                }, []);

                const currentWeight = metrics[0]?.w || 130;
                const proteinGoal = Math.round(currentWeight * 0.8);
                const pPct = Math.min((consumed.p / proteinGoal) * 100, 100);
                const circ = 2 * Math.PI * 40;
                const offset = circ - (pPct / 100) * circ;

                const handleSave = async () => {
                    const text = exData.map(e => `${e.name}\n${e.sets.map((s,i) => `S${i+1}: ${s.w||0}lb x ${s.r||0}`).join(' | ')}`).join('\n\n');
                    const payload = { type: 'workout', data: { type: activeWkt, content: text, date: new Date().toLocaleDateString() } };
                    
                    setLoading(true);
                    await fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(payload) });
                    window.location.reload();
                };

                if (loading) return h('div', {className:'h-screen flex items-center justify-center'}, h('i', {className:'fas fa-dna text-4xl text-blue-500 animate-pulse'}));

                return h('div', { className: 'app-container max-w-md mx-auto p-5 pb-10' },
                    h('div', { className: 'text-center py-6' },
                        h('h1', { className: 'text-5xl font-black italic accent-text' }, 'PHASE 15'),
                        h('p', { className: 'text-[9px] text-slate-500 font-bold uppercase tracking-[4px] mt-1' }, 'Elite Recomp Protocol')
                    ),

                    h('div', { className: 'flex mb-6 glass-strong rounded-2xl overflow-hidden' },
                        ['dashboard', 'plan', 'metrics'].map(t => h('button', { key: t, onClick: () => setTab(t), className: `tab-btn ${tab === t ? 'tab-active' : ''}` }, t))
                    ),

                    tab === 'dashboard' && h('div', { className: 'space-y-4' },
                        h('div', { className: 'glass-strong p-8 rounded-3xl flex flex-col items-center relative' },
                            h('svg', { className: 'progress-ring', width: '120', height: '120' },
                                h('circle', { className: 'text-slate-800', strokeWidth: '8', stroke: 'currentColor', fill: 'transparent', r: '40', cx: '60', cy: '60' }),
                                h('circle', { className: 'progress-ring__circle', strokeWidth: '8', strokeDasharray: circ, strokeDashoffset: offset, strokeLinecap: 'round', fill: 'transparent', r: '40', cx: '60', cy: '60' })
                            ),
                            h('div', { className: 'absolute top-[52px] text-center' },
                                h('p', { className: 'text-2xl font-black' }, Math.round(pPct), '%'),
                                h('p', { className: 'text-[8px] uppercase font-bold text-slate-500' }, 'Protein')
                            ),
                            h('p', { className: 'mt-4 text-xs font-bold text-blue-400' }, consumed.p, ' / ', proteinGoal, 'g (0.8x BW Target)')
                        ),

                        h('div', { className: 'grid grid-cols-2 gap-3' },
                            h('div', { className: 'glass-strong p-5 rounded-2xl text-center' },
                                h('p', { className: 'text-[10px] uppercase font-bold text-slate-500 mb-1' }, 'Current Streak'),
                                h('p', { className: 'text-2xl font-black text-orange-500' }, 'ðŸ”¥ 12 Days')
                            ),
                            h('div', { className: 'glass-strong p-5 rounded-2xl text-center' },
                                h('p', { className: 'text-[10px] uppercase font-bold text-slate-500 mb-1' }, 'Total Sessions'),
                                h('p', { className: 'text-2xl font-black text-emerald-500' }, workouts.length)
                            )
                        ),

                        h('div', { className: 'glass-strong p-5 rounded-2xl' },
                            h('h3', { className: 'text-xs font-black uppercase text-slate-400 mb-4' }, 'Recent Workouts'),
                            workouts.slice(0, 3).map((w, i) => h('div', { key: i, className: 'mb-4 last:mb-0 border-l-2 border-blue-500/30 pl-4' },
                                h('div', { className: 'flex justify-between text-[11px] mb-1' },
                                    h('span', { className: 'font-black text-blue-400 uppercase' }, w.type),
                                    h('span', { className: 'text-slate-500 font-bold' }, w.date)
                                ),
                                h('pre', { className: 'text-[10px] text-slate-300' }, w.content)
                            ))
                        )
                    ),

                    tab === 'plan' && h('div', { className: 'space-y-3' },
                        Object.keys(templates).map(p => 
                            h('div', { key: p, className: 'glass-strong p-5 rounded-2xl flex justify-between items-center' },
                                h('p', { className: 'text-sm font-black' }, p),
                                h('button', { 
                                    onClick: () => { 
                                        setActiveWkt(p); 
                                        setExData(templates[p].map(e => ({ name: e.n, sets: Array(e.s).fill({w:'', r:''}) }))); 
                                        setTab('workout'); 
                                    },
                                    className: 'bg-blue-600 px-4 py-2 rounded-lg font-black text-[10px]' 
                                }, 'START')
                            )
                        )
                    ),

                    tab === 'workout' && h('div', { className: 'space-y-4 pb-10' },
                        h('h2', { className: 'text-xl font-black italic' }, activeWkt),
                        exData.map((ex, i) => h('div', { key: i, className: 'glass-strong p-4 rounded-2xl' },
                            h('p', { className: 'text-sm font-bold text-blue-400 mb-3' }, ex.name),
                            ex.sets.map((s, si) => h('div', { key: si, className: 'flex gap-2 mb-2' },
                                h('input', { placeholder: 'Lbs', type: 'number', className: 'input-box flex-1', onChange: (e) => { const n = [...exData]; n[i].sets[si].w = e.target.value; setExData(n); }}),
                                h('input', { placeholder: 'Reps', type: 'number', className: 'input-box flex-1', onChange: (e) => { const n = [...exData]; n[i].sets[si].r = e.target.value; setExData(n); }})
                            ))
                        )),
                        h('button', { onClick: handleSave, className: 'w-full bg-emerald-600 p-5 rounded-2xl font-black uppercase text-xs' }, 'Sync to Sheet')
                    ),

                    tab === 'metrics' && h('div', { className: 'glass-strong p-6 rounded-3xl' },
                        h('p', { className: 'text-[10px] font-bold text-slate-500 uppercase mb-2' }, 'Log Bodyweight'),
                        h('input', { id: 'wt-val', type: 'number', placeholder: currentWeight, className: 'input-box mb-4' }),
                        h('button', { 
                            onClick: () => {
                                const val = document.getElementById('wt-val').value;
                                fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify({ type: 'metric', data: { w: val, date: new Date().toLocaleDateString() } }) })
                                .then(() => window.location.reload());
                            },
                            className: 'w-full bg-blue-600 p-4 rounded-xl font-black text-xs' 
                        }, 'Save Metric')
                    )
                );
            }
            ReactDOM.createRoot(document.getElementById('root')).render(h(App));
        });
    </script>
</body>
</html>