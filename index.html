<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PHASE 15 | ELITE TRACKER</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background: #05070a;
            color: white; margin: 0; min-height: 100vh; position: relative; overflow-x: hidden;
        }
        .bg-glow {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 70%, rgba(16, 185, 129, 0.05) 0%, transparent 50%);
            z-index: 0; pointer-events: none;
        }
        .glass-strong {
            background: rgba(15, 20, 35, 0.8); backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        .input-box { 
            background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(59, 130, 246, 0.2);
            color: white; border-radius: 12px; padding: 12px; width: 100%; text-align: center; 
            font-weight: 700; transition: all 0.2s;
        }
        .input-box:focus { border-color: #3b82f6; outline: none; background: rgba(59, 130, 246, 0.05); }
        .tab-btn { 
            flex: 1; padding: 16px; font-size: 10px; font-weight: 800; text-transform: uppercase;
            letter-spacing: 1px; color: #475569; border-bottom: 2px solid transparent; transition: all 0.3s;
        }
        .tab-active { color: #3b82f6; border-bottom: 2px solid #3b82f6; background: rgba(59, 130, 246, 0.05); }
        .accent-text { 
            background: linear-gradient(135deg, #60a5fa 0%, #34d399 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .btn-click { transition: transform 0.1s ease; }
        .btn-click:active { transform: scale(0.96); }
        .btn-primary { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); }
        .btn-success { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
    </style>
</head>
<body>
    <div class="bg-glow"></div>
    <div id="root"></div>
    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwA2DHXoElBhy242D5238NMfjS1c49bG2q5bRDjxbmswP1U9grG8PTipS_s6p-LpI7e/exec';
        
        const formGuides = {
            'Incline DB Press': 'https://www.youtube.com/watch?v=8iP6n_S8kP0',
            'Dips (Chest Focused)': 'https://www.youtube.com/watch?v=2z8JmcrW-As',
            'Overhead Press': 'https://www.youtube.com/watch?v=_RlRDWO2jfg',
            'Chin-Ups (Weighted)': 'https://www.youtube.com/watch?v=iYID-TsyzB0',
            'Back Squat': 'https://www.youtube.com/watch?v=gcNh17Ckjgg',
            'Deadlift': 'https://www.youtube.com/watch?v=VL5Ab0T07e4',
            'Bulgarian Split Squat': 'https://www.youtube.com/watch?v=hZ7p3-EovP4',
            'Lateral Raises': 'https://www.youtube.com/watch?v=3VkXWpGzAtU',
            'Hammer Curls': 'https://www.youtube.com/watch?v=TwD-YGVP4Bk',
            'Preacher Curls': 'https://www.youtube.com/watch?v=7M7m6Luv-N0',
            'Romanian Deadlift': 'https://www.youtube.com/watch?v=JCX81dx-9u4'
        };

        window.addEventListener('load', function() {
            const { createElement: h, useState, useEffect } = React;

            function App() {
                const [tab, setTab] = useState('dashboard');
                const [workouts, setWorkouts] = useState([]);
                const [metrics, setMetrics] = useState([]);
                const [loading, setLoading] = useState(true);
                const [activeWkt, setActiveWkt] = useState(null);
                const [exData, setExData] = useState([]);

                const templates = {
                    'Upper Push (Hypertrophy)': [{n: 'Incline DB Press', s: 3, r: '8-10'}, {n: 'Dips (Chest Focused)', s: 3, r: '10-12'}, {n: 'Overhead Press', s: 3, r: '8-10'}, {n: 'Lateral Raises', s: 3, r: '12-15'}],
                    'Upper Pull (Strength)': [{n: 'Chin-Ups (Weighted)', s: 3, r: '6-8'}, {n: 'Hammer Curls', s: 3, r: '10-12'}, {n: 'Preacher Curls', s: 3, r: '10-12'}, {n: 'Face Pulls', s: 3, r: '15-20'}],
                    'Lower Quad (Endurance)': [{n: 'Back Squat', s: 4, r: '8-10'}, {n: 'Leg Press', s: 3, r: '12-15'}, {n: 'Bulgarian Split Squat', s: 3, r: '10-12'}, {n: 'Calf Raises', s: 4, r: '15-20'}],
                    'Lower Ham (Power)': [{n: 'Deadlift', s: 3, r: '5-8'}, {n: 'Romanian Deadlift', s: 3, r: '10-12'}, {n: 'Leg Curls', s: 3, r: '12-15'}, {n: 'Hanging Leg Raises', s: 3, r: '15-20'}],
                    'Half-Marathon Prep': [{n: 'Zone 2 Foundation Run', s: 1, r: '45 min'}, {n: 'Speed Intervals', s: 6, r: '400m'}]
                };

                useEffect(() => {
                    async function fetchData() {
                        try {
                            const response = await fetch(SCRIPT_URL);
                            const data = await response.json();
                            setWorkouts(data.workouts || []);
                            setMetrics(data.metrics || []);
                        } catch (e) { console.error(e); }
                        setLoading(false);
                    }
                    fetchData();
                }, []);

                const saveWkt = () => {
                    const text = exData.map(e => `${e.name}\n${e.sets.map((s,i) => `S${i+1}: ${s.w || '0'}lb x ${s.r || '0'}`).join(' | ')}`).join('\n\n');
                    const log = { type: activeWkt, date: new Date().toLocaleDateString(), content: text };
                    setWorkouts([log, ...workouts]);
                    fetch(SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify({dataType:'lift', ...log}) });
                    setActiveWkt(null); setTab('dashboard');
                };

                const stats = (() => {
                    const latest = metrics[0] || {w: '--', bf: '--'};
                    return { w: latest.w, bf: latest.bf, s: [...new Set(workouts.map(w => w.date))].length };
                })();

                if (loading) return h('div', {className: 'h-screen flex flex-col items-center justify-center'}, h('i', {className: 'fas fa-dna text-4xl text-blue-500 animate-spin'}));

                return h('div', { className: 'app-container max-w-md mx-auto p-5 pb-12' },
                    h('header', { className: 'text-center py-8' },
                        h('h1', { className: 'text-5xl font-black italic accent-text tracking-tighter' }, 'PHASE 15'),
                        h('p', { className: 'text-[10px] text-slate-500 font-bold uppercase tracking-[4px] mt-1' }, 'Science-Based Elite')
                    ),

                    h('nav', { className: 'flex mb-8 glass-strong rounded-2xl overflow-hidden' },
                        ['dashboard', 'plan', 'metrics'].map(t => h('button', { key: t, onClick: () => setTab(t), className: `tab-btn ${tab === t ? 'tab-active' : ''}` }, t))
                    ),

                    tab === 'dashboard' && h('div', { className: 'space-y-6 animate-in fade-in duration-500' },
                        h('div', { className: 'grid grid-cols-3 gap-3' },
                            [{l:'Streak', v:stats.s, i:'fa-fire', c:'text-orange-500'}, {l:'Weight', v:stats.w, i:'fa-weight-scale', c:'text-blue-500'}, {l:'Body Fat', v:stats.bf+'%', i:'fa-bolt', c:'text-emerald-500'}].map(s => 
                                h('div', { key: s.l, className: 'glass-strong p-4 rounded-2xl text-center' }, h('i', { className: `fas ${s.i} ${s.c} mb-2` }), h('p', { className: 'text-xl font-black' }, s.v), h('p', { className: 'text-[8px] uppercase font-bold text-slate-400' }, s.l))
                            )
                        ),
                        h('div', { className: 'glass-strong p-6 rounded-2xl' },
                            h('h3', { className: 'text-[10px] font-black uppercase text-blue-400 mb-4' }, 'Last Session'),
                            workouts.length > 0 ? h('div', null,
                                h('div', { className: 'flex justify-between items-center mb-2' },
                                    h('span', { className: 'text-sm font-black' }, workouts[0].type),
                                    h('span', { className: 'text-[10px] text-slate-500' }, workouts[0].date)
                                ),
                                h('pre', { className: 'text-[10px] text-slate-400 whitespace-pre-wrap leading-relaxed' }, workouts[0].content)
                            ) : h('p', { className: 'text-xs text-slate-500 italic' }, 'No data synced.')
                        ),
                        h('button', { onClick: () => setTab('plan'), className: 'btn-click w-full btn-primary p-5 rounded-2xl font-black uppercase text-xs tracking-widest' }, 'Proceed to Training')
                    ),

                    tab === 'plan' && h('div', { className: 'space-y-3' },
                        ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'].map(d => {
                            const dayPlan = { Monday:'Upper Push (Hypertrophy)', Tuesday:'Half-Marathon Prep', Wednesday:'Lower Quad (Endurance)', Thursday:'Upper Pull (Strength)', Friday:'Lower Ham (Power)', Saturday:'Half-Marathon Prep', Sunday:'Rest & Recovery' };
                            const isRest = dayPlan[d].includes('Rest');
                            return h('div', { key: d, className: `glass-strong p-5 rounded-2xl flex justify-between items-center ${isRest ? 'opacity-50' : ''}` },
                                h('div', null, h('p', { className: 'text-[10px] font-bold text-blue-400 uppercase mb-1' }, d), h('p', { className: 'text-sm font-black' }, dayPlan[d])),
                                !isRest && h('button', { onClick: () => { 
                                    setActiveWkt(dayPlan[d]); 
                                    setExData(templates[dayPlan[d]].map(obj => ({ name: obj.n, target: obj.r, sets: Array(obj.s).fill({w:'', r:''}) }))); 
                                    setTab('workout'); 
                                }, className: 'btn-click btn-primary px-5 py-2 rounded-xl font-black text-[10px]' }, 'START')
                            );
                        })
                    ),

                    tab === 'workout' && (activeWkt ? h('div', { className: 'space-y-4 pb-24' },
                        h('div', { className: 'flex justify-between items-end mb-2' },
                            h('div', null,
                                h('h2', { className: 'text-2xl font-black text-white italic' }, activeWkt.split(' ')[0]),
                                h('p', { className: 'text-xs font-bold text-blue-400 uppercase' }, activeWkt.split(' ').slice(1).join(' '))
                            ),
                            h('button', { onClick: () => setTab('plan'), className: 'text-[10px] font-black text-slate-500' }, 'ABORT')
                        ),

                        // Context History Section
                        workouts.filter(w => w.type === activeWkt).length > 0 && h('div', { className: 'glass-strong p-4 rounded-2xl border-l-2 border-blue-500' },
                            h('p', { className: 'text-[9px] font-black uppercase text-slate-500 mb-2' }, 'Previous Best'),
                            h('pre', { className: 'text-[10px] text-slate-300' }, workouts.filter(w => w.type === activeWkt)[0].content.split('\n\n')[0])
                        ),

                        exData.map((ex, i) => h('div', { key: i, className: 'glass-strong p-5 rounded-2xl' },
                            h('div', { className: 'flex justify-between items-start mb-4' }, 
                                h('div', null,
                                    h('p', {className:'text-sm font-black'}, ex.name),
                                    h('span', {className:'text-[10px] font-bold text-blue-400 uppercase'}, 'Rep Range: '+ex.target)
                                ),
                                formGuides[ex.name] && h('a', { href: formGuides[ex.name], target: '_blank', className: 'btn-click flex items-center gap-1.5 bg-red-500/10 hover:bg-red-500/20 px-3 py-1.5 rounded-full border border-red-500/20' },
                                    h('i', { className: 'fab fa-youtube text-red-500 text-[10px]' }),
                                    h('span', { className: 'text-[9px] font-black text-red-500' }, 'FORM')
                                )
                            ),
                            ex.sets.map((set, si) => h('div', { key: si, className: 'flex gap-2 mb-2' },
                                h('input', { placeholder: 'LBS', type: 'number', className: 'input-box flex-1', value: set.w, onChange: (e) => { const n = [...exData]; n[i].sets[si] = {...n[i].sets[si], w: e.target.value}; setExData(n); }}),
                                h('input', { placeholder: 'REPS', type: 'number', className: 'input-box flex-1', value: set.r, onChange: (e) => { const n = [...exData]; n[i].sets[si] = {...n[i].sets[si], r: e.target.value}; setExData(n); }})
                            ))
                        )),
                        h('button', { onClick: saveWkt, className: 'btn-click fixed bottom-6 left-5 right-5 max-w-md mx-auto btn-success p-5 rounded-2xl font-black uppercase text-xs shadow-2xl z-50' }, 'Complete & Sync to Cloud')
                    ) : null),

                    tab === 'metrics' && h('div', { className: 'space-y-4' },
                        h('div', { className: 'glass-strong p-6 rounded-2xl' },
                            h('label', { className: 'block text-[10px] font-black text-slate-500 uppercase mb-4' }, 'Morning Metrics'),
                            h('div', { className: 'flex gap-3 mb-4' },
                                h('input', { id: 'w-val', type: 'number', placeholder: 'WEIGHT (LB)', className: 'input-box flex-1' }),
                                h('input', { id: 'bf-val', type: 'number', placeholder: 'BODYFAT %', className: 'input-box flex-1' })
                            ),
                            h('button', { onClick: () => {
                                const w = document.getElementById('w-val').value;
                                const bf = document.getElementById('bf-val').value;
                                if(!w) return;
                                const log = { w, bf, date: new Date().toLocaleDateString() };
                                setMetrics([log, ...metrics]);
                                fetch(SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify({dataType:'metric', ...log}) });
                                setTab('dashboard');
                            }, className: 'btn-click w-full btn-success p-4 rounded-xl font-black uppercase text-xs' }, 'Log Progress')
                        )
                    )
                );
            }
            ReactDOM.createRoot(document.getElementById('root')).render(h(App));
        });
    </script>
</body>
</html>